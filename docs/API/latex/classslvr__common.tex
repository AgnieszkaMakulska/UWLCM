\doxysection{slvr\+\_\+common\texorpdfstring{$<$}{<} ct\+\_\+params\+\_\+t \texorpdfstring{$>$}{>}}
\hypertarget{classslvr__common}{}\label{classslvr__common}\index{slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}}


Base solver class providing common functionality for all solver variants.  




{\ttfamily \#include $<$slvr\+\_\+common.\+hpp$>$}

\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classslvr__common_acfc4aede3290463ac6e2cf2e0dbf48d2}\label{classslvr__common_acfc4aede3290463ac6e2cf2e0dbf48d2} 
virtual void {\bfseries get\+\_\+puddle} ()=0
\begin{DoxyCompactList}\small\item\em Retrieve precipitation (puddle) diagnostics. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classslvr__common_a59f4036f2a16af2d355b9bc2fd551731}{get\+\_\+rain}} ()=0
\begin{DoxyCompactList}\small\item\em Query whether rain is active. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classslvr__common_a73d691f6322c90001eb125559e864760}{set\+\_\+rain}} (bool)=0
\begin{DoxyCompactList}\small\item\em Enable or disable rain. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__common_a929c296e24f20ac45e880c2484d382a4}{hook\+\_\+ante\+\_\+loop}} (int nt)
\begin{DoxyCompactList}\small\item\em Called before the simulation time loop starts. \end{DoxyCompactList}\item 
\Hypertarget{classslvr__common_adfdf0b5348ce51a4602daabfeff41d6b}\label{classslvr__common_adfdf0b5348ce51a4602daabfeff41d6b} 
void {\bfseries hook\+\_\+ante\+\_\+step} ()
\begin{DoxyCompactList}\small\item\em Called before each timestep. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__common_a2eb2c924dd00c044df9865172e37c387}{rv\+\_\+src}} ()
\begin{DoxyCompactList}\small\item\em Apply source term for water vapor (rv) due to surface fluxes, large-\/scale vertical motion, horizontal advection, and per-\/level nudging. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__common_a3b6bf0a40342e19d04ec23e830e182a0}{th\+\_\+src}} (typename parent\+\_\+t\+::arr\+\_\+t \&rv)
\begin{DoxyCompactList}\small\item\em Apply source term for potential temperature (th) due to radiation, surface fluxes, large-\/scale motions, and per-\/level nudging. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__common_a0e986e6e48858a6466265573d4fd2dbf}{w\+\_\+src}} (typename parent\+\_\+t\+::arr\+\_\+t \&th, typename parent\+\_\+t\+::arr\+\_\+t \&rv, const int at)
\begin{DoxyCompactList}\small\item\em Apply source term for vertical velocity (w) due to buoyancy and optionally subsidence. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__common_a07526fb15342a380841b6fe581f96988}{update\+\_\+rhs}} (arrvec\+\_\+t$<$ typename parent\+\_\+t\+::arr\+\_\+t $>$ \&rhs, const typename parent\+\_\+t\+::real\+\_\+t \&dt, const int \&at)
\begin{DoxyCompactList}\small\item\em Update RHS terms. \end{DoxyCompactList}\item 
\Hypertarget{classslvr__common_af96d4476a8a9126377f9fa79055e3f91}\label{classslvr__common_af96d4476a8a9126377f9fa79055e3f91} 
void {\bfseries hook\+\_\+post\+\_\+step} ()
\begin{DoxyCompactList}\small\item\em Called after each timestep. \end{DoxyCompactList}\item 
\Hypertarget{classslvr__common_a921cb5d3106e5d8de9f475ad4194518f}\label{classslvr__common_a921cb5d3106e5d8de9f475ad4194518f} 
virtual void {\bfseries diag} ()
\begin{DoxyCompactList}\small\item\em Perform diagnostic output. \end{DoxyCompactList}\item 
\Hypertarget{classslvr__common_aa57377bbea1095d1dbf25160af0188e3}\label{classslvr__common_aa57377bbea1095d1dbf25160af0188e3} 
void {\bfseries record\+\_\+all} ()
\begin{DoxyCompactList}\small\item\em Record all output fields and diagnostics. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$class ct\+\_\+params\+\_\+t$>$\newline
class slvr\+\_\+common$<$ ct\+\_\+params\+\_\+t $>$}
Base solver class providing common functionality for all solver variants. 


\begin{DoxyTemplParams}{Template Parameters}
{\em ct\+\_\+params\+\_\+t} & Compile-\/time parameters struct controlling solver configuration. \\
\hline
\end{DoxyTemplParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{classslvr__common_a59f4036f2a16af2d355b9bc2fd551731}\index{slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}!get\_rain@{get\_rain}}
\index{get\_rain@{get\_rain}!slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{get\_rain()}{get\_rain()}}
{\footnotesize\ttfamily \label{classslvr__common_a59f4036f2a16af2d355b9bc2fd551731} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
virtual bool get\+\_\+rain (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}



Query whether rain is active. 

\begin{DoxyReturn}{Returns}
true if rain is active. 
\end{DoxyReturn}
\Hypertarget{classslvr__common_a929c296e24f20ac45e880c2484d382a4}\index{slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}!hook\_ante\_loop@{hook\_ante\_loop}}
\index{hook\_ante\_loop@{hook\_ante\_loop}!slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{hook\_ante\_loop()}{hook\_ante\_loop()}}
{\footnotesize\ttfamily \label{classslvr__common_a929c296e24f20ac45e880c2484d382a4} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void hook\+\_\+ante\+\_\+loop (\begin{DoxyParamCaption}\item[{int}]{nt}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Called before the simulation time loop starts. 


\begin{DoxyParams}{Parameters}
{\em nt} & Number of timesteps. \\
\hline
\end{DoxyParams}
\Hypertarget{classslvr__common_a2eb2c924dd00c044df9865172e37c387}\index{slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}!rv\_src@{rv\_src}}
\index{rv\_src@{rv\_src}!slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{rv\_src()}{rv\_src()}}
{\footnotesize\ttfamily \label{classslvr__common_a2eb2c924dd00c044df9865172e37c387} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void rv\+\_\+src (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Apply source term for water vapor (rv) due to surface fluxes, large-\/scale vertical motion, horizontal advection, and per-\/level nudging. 

If {\ttfamily params.\+rv\+\_\+src} is true, the function sequentially applies\+:
\begin{DoxyItemize}
\item surface latent heat flux,
\item subsidence (large-\/scale vertical wind),
\item large-\/scale horizontal advection,
\item nudging of the mean water vapor. The forcing coefficient {\ttfamily alpha} accumulates contributions from all sources, and {\ttfamily beta} is set to zero. 
\end{DoxyItemize}\Hypertarget{classslvr__common_a73d691f6322c90001eb125559e864760}\index{slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}!set\_rain@{set\_rain}}
\index{set\_rain@{set\_rain}!slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{set\_rain()}{set\_rain()}}
{\footnotesize\ttfamily \label{classslvr__common_a73d691f6322c90001eb125559e864760} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
virtual void set\+\_\+rain (\begin{DoxyParamCaption}\item[{bool}]{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}



Enable or disable rain. 


\begin{DoxyParams}{Parameters}
{\em active} & Whether rain should be active. \\
\hline
\end{DoxyParams}
\Hypertarget{classslvr__common_a3b6bf0a40342e19d04ec23e830e182a0}\index{slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}!th\_src@{th\_src}}
\index{th\_src@{th\_src}!slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{th\_src()}{th\_src()}}
{\footnotesize\ttfamily \label{classslvr__common_a3b6bf0a40342e19d04ec23e830e182a0} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void th\+\_\+src (\begin{DoxyParamCaption}\item[{typename parent\+\_\+t\+::arr\+\_\+t \&}]{rv}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Apply source term for potential temperature (th) due to radiation, surface fluxes, large-\/scale motions, and per-\/level nudging. 

If {\ttfamily params.\+th\+\_\+src} is true, the function sequentially applies\+:
\begin{DoxyItemize}
\item radiative heating,
\item vertical flux divergence to compute local heating rate,
\item surface sensible heat flux,
\item subsidence (large-\/scale vertical wind),
\item large-\/scale horizontal advection,
\item nudging of the mean potential temperature.
\end{DoxyItemize}

The forcing coefficient {\ttfamily alpha} accumulates contributions from all sources, corrected for specific heat and density. The {\ttfamily beta} coefficient is set to zero.


\begin{DoxyParams}{Parameters}
{\em rv} & Array of water vapor used for computing heat capacities and radiative effects. \\
\hline
\end{DoxyParams}
\Hypertarget{classslvr__common_a07526fb15342a380841b6fe581f96988}\index{slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}!update\_rhs@{update\_rhs}}
\index{update\_rhs@{update\_rhs}!slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{update\_rhs()}{update\_rhs()}}
{\footnotesize\ttfamily \label{classslvr__common_a07526fb15342a380841b6fe581f96988} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void update\+\_\+rhs (\begin{DoxyParamCaption}\item[{arrvec\+\_\+t$<$ typename parent\+\_\+t\+::arr\+\_\+t $>$ \&}]{rhs}{, }\item[{const typename parent\+\_\+t\+::real\+\_\+t \&}]{dt}{, }\item[{const int \&}]{at}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Update RHS terms. 


\begin{DoxyParams}{Parameters}
{\em rhs} & Right-\/hand side arrays. \\
\hline
{\em dt} & Timestep. \\
\hline
{\em at} & Integration stage (0 for Euler, 1 for trapezoidal). \\
\hline
\end{DoxyParams}
\Hypertarget{classslvr__common_a0e986e6e48858a6466265573d4fd2dbf}\index{slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}!w\_src@{w\_src}}
\index{w\_src@{w\_src}!slvr\_common$<$ ct\_params\_t $>$@{slvr\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{w\_src()}{w\_src()}}
{\footnotesize\ttfamily \label{classslvr__common_a0e986e6e48858a6466265573d4fd2dbf} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void w\+\_\+src (\begin{DoxyParamCaption}\item[{typename parent\+\_\+t\+::arr\+\_\+t \&}]{th}{, }\item[{typename parent\+\_\+t\+::arr\+\_\+t \&}]{rv}{, }\item[{const int}]{at}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Apply source term for vertical velocity (w) due to buoyancy and optionally subsidence. 

The function computes buoyancy forcing based on {\ttfamily th} and {\ttfamily rv}, applies trapezoidal scaling (halving {\ttfamily alpha}), and optionally adds large-\/scale vertical motion if {\ttfamily at == 0} and {\ttfamily params.\+vel\+\_\+subsidence} is true.


\begin{DoxyParams}{Parameters}
{\em th} & Array of potential temperature. \\
\hline
{\em rv} & Array of water vapor. \\
\hline
{\em at} & Integration stage (0 for first stage, 1 for trapezoidal second stage). \\
\hline
\end{DoxyParams}
