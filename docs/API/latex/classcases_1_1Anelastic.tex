\doxysection{Anelastic\texorpdfstring{$<$}{<} case\+\_\+ct\+\_\+params\+\_\+t, n\+\_\+dims \texorpdfstring{$>$}{>}}
\hypertarget{classcases_1_1Anelastic}{}\label{classcases_1_1Anelastic}\index{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$@{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$}}


Base class for anelastic cloud simulation cases.  




{\ttfamily \#include $<$Anelastic.\+hpp$>$}



Inheritance diagram for Anelastic\texorpdfstring{$<$}{<} case\+\_\+ct\+\_\+params\+\_\+t, n\+\_\+dims \texorpdfstring{$>$}{>}\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classcases_1_1Anelastic__inherit__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual quantity$<$ si\+::temperature, real\+\_\+t $>$ \mbox{\hyperlink{classcases_1_1Anelastic_a2084be2f345d869840a8c42b55076aa0}{th\+\_\+l}} (const real\+\_\+t \&z)
\begin{DoxyCompactList}\small\item\em Liquid water potential temperature at height z. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcases_1_1Anelastic_aa8e89e6fc41d8df755ee8cd73a4da92e}{env\+\_\+prof}} (detail\+::profiles\+\_\+t \&profs, int nz)
\begin{DoxyCompactList}\small\item\em Initialize environmental profiles of theta and water vapor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classcases_1_1Anelastic_ae6d347470267c38381297c0450698ab2}{ref\+\_\+prof}} (detail\+::profiles\+\_\+t \&profs, int nz)
\begin{DoxyCompactList}\small\item\em Initialize reference profiles for theta and dry air density. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classcases_1_1CasesCommon}{Cases\+Common$<$ case\+\_\+ct\+\_\+params\+\_\+t, n\+\_\+dims $>$}}}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$class arr\+\_\+t$>$ }\\void {\bfseries make\+\_\+cyclic} (arr\+\_\+t arr, typename std\+::enable\+\_\+if$<$ arr\+\_\+t\+::rank\+\_\+==2 $>$\+::type \texorpdfstring{$\ast$}{*}=0)
\begin{DoxyCompactList}\small\item\em Enforce cyclic boundary conditions in horizontal directions (2D). \end{DoxyCompactList}\item 
{\footnotesize template$<$class arr\+\_\+t$>$ }\\void {\bfseries make\+\_\+cyclic} (arr\+\_\+t arr, typename std\+::enable\+\_\+if$<$ arr\+\_\+t\+::rank\+\_\+==3 $>$\+::type \texorpdfstring{$\ast$}{*}=0)
\begin{DoxyCompactList}\small\item\em Enforce cyclic boundary conditions in horizontal directions (3D). \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classcases_1_1CasesCommon}{Cases\+Common$<$ case\+\_\+ct\+\_\+params\+\_\+t, n\+\_\+dims $>$}}}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$bool enable\+\_\+sgs = case\+\_\+ct\+\_\+params\+\_\+t\+::enable\+\_\+sgs$>$ }\\void \mbox{\hyperlink{classcases_1_1CasesCommon_a1fc8f98b0af6a239483bf5ab19560faa}{setopts\+\_\+sgs}} (rt\+\_\+params\+\_\+t \&params, typename std\+::enable\+\_\+if$<$!enable\+\_\+sgs $>$\+::type \texorpdfstring{$\ast$}{*}=0)
\begin{DoxyCompactList}\small\item\em Set SGS options if SGS turbulence is enabled. \end{DoxyCompactList}\item 
virtual void {\bfseries setopts} (rt\+\_\+params\+\_\+t \&params, const int nps\mbox{[}$\,$\mbox{]}, const user\+\_\+params\+\_\+t \&user\+\_\+params)
\begin{DoxyCompactList}\small\item\em Virtual function to set case-\/specific options. \end{DoxyCompactList}\item 
virtual void {\bfseries intcond} (concurr\+\_\+any\+\_\+t \&concurr, arr\+\_\+1\+D\+\_\+t \&rhod, arr\+\_\+1\+D\+\_\+t \&th\+\_\+e, arr\+\_\+1\+D\+\_\+t \&rv\+\_\+e, arr\+\_\+1\+D\+\_\+t \&rl\+\_\+e, arr\+\_\+1\+D\+\_\+t \&p\+\_\+e, int rng\+\_\+seed)=0
\begin{DoxyCompactList}\small\item\em Virtual function to set case-\/specific initial conditions. \end{DoxyCompactList}\item 
virtual void {\bfseries set\+\_\+profs} (detail\+::profiles\+\_\+t \&profs, int nz, const user\+\_\+params\+\_\+t \&user\+\_\+params)
\begin{DoxyCompactList}\small\item\em Initialize profiles for SGS and surface fluxes. \end{DoxyCompactList}\item 
virtual void {\bfseries update\+\_\+surf\+\_\+flux\+\_\+sens} (blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ surf\+\_\+flux\+\_\+sens, blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ th\+\_\+ground, blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ U\+\_\+ground, const real\+\_\+t \&U\+\_\+ground\+\_\+z, const int \&timestep, const real\+\_\+t \&dt, const real\+\_\+t \&dx, const real\+\_\+t \&dy=0)
\begin{DoxyCompactList}\small\item\em Update surface fluxes (sensible heat). \end{DoxyCompactList}\item 
virtual void {\bfseries update\+\_\+surf\+\_\+flux\+\_\+lat} (blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ surf\+\_\+flux\+\_\+lat, blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ rt\+\_\+ground, blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ U\+\_\+ground, const real\+\_\+t \&U\+\_\+ground\+\_\+z, const int \&timestep, const real\+\_\+t \&dt, const real\+\_\+t \&dx, const real\+\_\+t \&dy=0)
\begin{DoxyCompactList}\small\item\em Update surface fluxes (latent heat). \end{DoxyCompactList}\item 
virtual void {\bfseries update\+\_\+surf\+\_\+flux\+\_\+uv} (blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ surf\+\_\+flux\+\_\+uv, blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ uv\+\_\+ground, blitz\+::\+Array$<$ real\+\_\+t, n\+\_\+dims $>$ U\+\_\+ground, const real\+\_\+t \&U\+\_\+ground\+\_\+z, const int \&timestep, const real\+\_\+t \&dt, const real\+\_\+t \&dx, const real\+\_\+t \&dy=0, const real\+\_\+t \&uv\+\_\+mean=0)
\begin{DoxyCompactList}\small\item\em Update surface fluxes (momentum). \end{DoxyCompactList}\item 
virtual void {\bfseries update\+\_\+rv\+\_\+\+LS} (blitz\+::\+Array$<$ real\+\_\+t, 1 $>$ rv\+\_\+\+LS, int timestep, real\+\_\+t dt, real\+\_\+t dz)
\begin{DoxyCompactList}\small\item\em Update large-\/scale water vapor tendencies. \end{DoxyCompactList}\item 
virtual void {\bfseries update\+\_\+th\+\_\+\+LS} (blitz\+::\+Array$<$ real\+\_\+t, 1 $>$ th\+\_\+\+LS, int timestep, real\+\_\+t dt, real\+\_\+t dz)
\begin{DoxyCompactList}\small\item\em Update large-\/scale potential temperature tendencies. \end{DoxyCompactList}\item 
{\bfseries Cases\+Common} ()
\begin{DoxyCompactList}\small\item\em Constructor\+: sets default DYCOMS parameters. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$class case\+\_\+ct\+\_\+params\+\_\+t, int n\+\_\+dims$>$\newline
class cases\+::\+Anelastic$<$ case\+\_\+ct\+\_\+params\+\_\+t, n\+\_\+dims $>$}
Base class for anelastic cloud simulation cases. 

Provides initialization of environmental and reference profiles of potential temperature and water vapor, following the anelastic approximation. Designed to be extended by specific cases with defined theta and mixing ratio profiles.


\begin{DoxyTemplParams}{Template Parameters}
{\em case\+\_\+ct\+\_\+params\+\_\+t} & Compile-\/time parameters for the case \\
\hline
{\em n\+\_\+dims} & Number of spatial dimensions (2 or 3) \\
\hline
\end{DoxyTemplParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{classcases_1_1Anelastic_aa8e89e6fc41d8df755ee8cd73a4da92e}\index{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$@{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$}!env\_prof@{env\_prof}}
\index{env\_prof@{env\_prof}!Anelastic$<$ case\_ct\_params\_t, n\_dims $>$@{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$}}
\doxysubsubsection{\texorpdfstring{env\_prof()}{env\_prof()}}
{\footnotesize\ttfamily \label{classcases_1_1Anelastic_aa8e89e6fc41d8df755ee8cd73a4da92e} 
template$<$class case\+\_\+ct\+\_\+params\+\_\+t, int n\+\_\+dims$>$ \\
void env\+\_\+prof (\begin{DoxyParamCaption}\item[{detail\+::profiles\+\_\+t \&}]{profs}{, }\item[{int}]{nz}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Initialize environmental profiles of theta and water vapor. 

Calculates initial temperature, pressure, water vapor, and liquid water mixing ratios using a moist thermodynamic framework.


\begin{DoxyParams}{Parameters}
{\em profs} & Reference to profiles structure to populate \\
\hline
{\em nz} & Number of vertical levels \\
\hline
\end{DoxyParams}
\Hypertarget{classcases_1_1Anelastic_ae6d347470267c38381297c0450698ab2}\index{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$@{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$}!ref\_prof@{ref\_prof}}
\index{ref\_prof@{ref\_prof}!Anelastic$<$ case\_ct\_params\_t, n\_dims $>$@{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$}}
\doxysubsubsection{\texorpdfstring{ref\_prof()}{ref\_prof()}}
{\footnotesize\ttfamily \label{classcases_1_1Anelastic_ae6d347470267c38381297c0450698ab2} 
template$<$class case\+\_\+ct\+\_\+params\+\_\+t, int n\+\_\+dims$>$ \\
void ref\+\_\+prof (\begin{DoxyParamCaption}\item[{detail\+::profiles\+\_\+t \&}]{profs}{, }\item[{int}]{nz}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}



Initialize reference profiles for theta and dry air density. 

Computes reference potential temperature and dry air density profiles based on environmental profiles. Used for stability and anelastic calculations.


\begin{DoxyParams}{Parameters}
{\em profs} & Reference to profiles structure to populate \\
\hline
{\em nz} & Number of vertical levels \\
\hline
\end{DoxyParams}
\Hypertarget{classcases_1_1Anelastic_a2084be2f345d869840a8c42b55076aa0}\index{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$@{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$}!th\_l@{th\_l}}
\index{th\_l@{th\_l}!Anelastic$<$ case\_ct\_params\_t, n\_dims $>$@{Anelastic$<$ case\_ct\_params\_t, n\_dims $>$}}
\doxysubsubsection{\texorpdfstring{th\_l()}{th\_l()}}
{\footnotesize\ttfamily \label{classcases_1_1Anelastic_a2084be2f345d869840a8c42b55076aa0} 
template$<$class case\+\_\+ct\+\_\+params\+\_\+t, int n\+\_\+dims$>$ \\
virtual quantity$<$ si\+::temperature, real\+\_\+t $>$ th\+\_\+l (\begin{DoxyParamCaption}\item[{const real\+\_\+t \&}]{z}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Liquid water potential temperature at height z. 

Must be implemented in derived classes. 
\begin{DoxyParams}{Parameters}
{\em z} & Height (m) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Potential temperature (K) 
\end{DoxyReturn}


Reimplemented in \mbox{\hyperlink{classcases_1_1rico_1_1Rico11Common_a07c7b1d8f55ee091b995785c2ebc7053}{Rico11\+Common$<$ case\+\_\+ct\+\_\+params\+\_\+t, n\+\_\+dims $>$}}.

