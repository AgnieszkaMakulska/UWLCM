\doxysection{slvr\+\_\+blk\+\_\+1m\+\_\+common\texorpdfstring{$<$}{<} ct\+\_\+params\+\_\+t \texorpdfstring{$>$}{>}}
\hypertarget{classslvr__blk__1m__common}{}\label{classslvr__blk__1m__common}\index{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$}}


Single-\/moment bulk microphysics solver (common functionality)  




{\ttfamily \#include $<$slvr\+\_\+blk\+\_\+1m\+\_\+common.\+hpp$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classslvr__blk__1m__common_a9d61aec26a13f9277adb2c2ce2033b31}{update\+\_\+rhs}} (libmpdataxx\+::arrvec\+\_\+t$<$ typename parent\+\_\+t\+::arr\+\_\+t $>$ \&rhs, const typename parent\+\_\+t\+::real\+\_\+t \&dt, const int \&at)
\begin{DoxyCompactList}\small\item\em Update the right-\/hand side (RHS) of prognostic equations for a time step. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classslvr__blk__1m__common_aab1df2789797c5b479d81a6b5869a53f}{rc\+\_\+src}} ()
\begin{DoxyCompactList}\small\item\em Source term for cloud water mixing ratio (rc) due to large-\/scale forcings. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__blk__1m__common_ae1055159bcbfa0beb14dc3e96579d5a7}{rr\+\_\+src}} ()
\begin{DoxyCompactList}\small\item\em Source term for rain water mixing ratio (rr) due to large-\/scale forcings. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$class ct\+\_\+params\+\_\+t$>$\newline
class slvr\+\_\+blk\+\_\+1m\+\_\+common$<$ ct\+\_\+params\+\_\+t $>$}
Single-\/moment bulk microphysics solver (common functionality) 

Template class implementing a common base for single-\/moment bulk microphysics schemes. Selects the parent solver depending on the SGS scheme (ILES vs SGS). Provides functions for condensation/evaporation adjustment, precipitation handling, and microphysics diagnostics.


\begin{DoxyTemplParams}{Template Parameters}
{\em ct\+\_\+params\+\_\+t} & Compile-\/time parameters defining solver configuration \\
\hline
\end{DoxyTemplParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{classslvr__blk__1m__common_aab1df2789797c5b479d81a6b5869a53f}\index{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$}!rc\_src@{rc\_src}}
\index{rc\_src@{rc\_src}!slvr\_blk\_1m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{rc\_src()}{rc\_src()}}
{\footnotesize\ttfamily \label{classslvr__blk__1m__common_aab1df2789797c5b479d81a6b5869a53f} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void rc\+\_\+src (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Source term for cloud water mixing ratio (rc) due to large-\/scale forcings. 

Applies large-\/scale vertical wind (subsidence) and optional nudging to the cloud water field. Updates the {\ttfamily alpha} and {\ttfamily beta} arrays that are used in the solver for forcing calculations.


\begin{DoxyItemize}
\item If {\ttfamily params.\+rc\+\_\+src} is true, applies subsidence from parent class and sets {\ttfamily alpha} from forcing array {\ttfamily F}.
\item Otherwise, {\ttfamily alpha} is set to zero. 
\end{DoxyItemize}\Hypertarget{classslvr__blk__1m__common_ae1055159bcbfa0beb14dc3e96579d5a7}\index{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$}!rr\_src@{rr\_src}}
\index{rr\_src@{rr\_src}!slvr\_blk\_1m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{rr\_src()}{rr\_src()}}
{\footnotesize\ttfamily \label{classslvr__blk__1m__common_ae1055159bcbfa0beb14dc3e96579d5a7} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void rr\+\_\+src (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Source term for rain water mixing ratio (rr) due to large-\/scale forcings. 

Applies large-\/scale vertical wind (subsidence) and optional nudging to the rain water field. Updates the {\ttfamily alpha} and {\ttfamily beta} arrays that are used in the solver for forcing calculations.


\begin{DoxyItemize}
\item If {\ttfamily params.\+rr\+\_\+src} is true, applies subsidence from parent class and sets {\ttfamily alpha} from forcing array {\ttfamily F}.
\item Otherwise, {\ttfamily alpha} is set to zero. 
\end{DoxyItemize}\Hypertarget{classslvr__blk__1m__common_a9d61aec26a13f9277adb2c2ce2033b31}\index{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$}!update\_rhs@{update\_rhs}}
\index{update\_rhs@{update\_rhs}!slvr\_blk\_1m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_1m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{update\_rhs()}{update\_rhs()}}
{\footnotesize\ttfamily \label{classslvr__blk__1m__common_a9d61aec26a13f9277adb2c2ce2033b31} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void update\+\_\+rhs (\begin{DoxyParamCaption}\item[{libmpdataxx\+::arrvec\+\_\+t$<$ typename parent\+\_\+t\+::arr\+\_\+t $>$ \&}]{rhs}{, }\item[{const typename parent\+\_\+t\+::real\+\_\+t \&}]{dt}{, }\item[{const int \&}]{at}{}\end{DoxyParamCaption})}



Update the right-\/hand side (RHS) of prognostic equations for a time step. 

This function computes the RHS of the single-\/moment bulk microphysics equations for temperature, water vapor, cloud water, and rain water. It includes\+:
\begin{DoxyItemize}
\item storing total liquid water for buoyancy,
\item cell-\/wise microphysics updates via libcloudph++ {\ttfamily rhs\+\_\+cellwise\+\_\+nwtrph},
\item large-\/scale forcing (subsidence, nudging) via {\ttfamily \doxylink{classslvr__blk__1m__common_aab1df2789797c5b479d81a6b5869a53f}{rc\+\_\+src()}} and {\ttfamily \doxylink{classslvr__blk__1m__common_ae1055159bcbfa0beb14dc3e96579d5a7}{rr\+\_\+src()}},
\item optional subgrid-\/scale (SGS) scalar forces if an SGS scheme is active.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em rhs} & Vector of RHS arrays for all prognostic variables \\
\hline
{\em dt} & Time step size \\
\hline
{\em at} & Step index\+:
\begin{DoxyItemize}
\item 0\+: first step of Euler or trapezoidal integration
\item 1\+: second step of trapezoidal integration 
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
