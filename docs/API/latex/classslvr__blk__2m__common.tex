\doxysection{slvr\+\_\+blk\+\_\+2m\+\_\+common\texorpdfstring{$<$}{<} ct\+\_\+params\+\_\+t \texorpdfstring{$>$}{>}}
\hypertarget{classslvr__blk__2m__common}{}\label{classslvr__blk__2m__common}\index{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}}


Common base class for 2-\/moment bulk microphysics solver.  




{\ttfamily \#include $<$slvr\+\_\+blk\+\_\+2m\+\_\+common.\+hpp$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classslvr__blk__2m__common_a9d61aec26a13f9277adb2c2ce2033b31}{update\+\_\+rhs}} (libmpdataxx\+::arrvec\+\_\+t$<$ typename parent\+\_\+t\+::arr\+\_\+t $>$ \&rhs, const typename parent\+\_\+t\+::real\+\_\+t \&dt, const int \&at)
\begin{DoxyCompactList}\small\item\em Update the right-\/hand-\/side of the prognostic equations. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classslvr__blk__2m__common_ad5085adafa9d68b1e69d0ac541a4fc4f}{slvr\+\_\+blk\+\_\+2m\+\_\+common}} (typename parent\+\_\+t\+::ctor\+\_\+args\+\_\+t args, const rt\+\_\+params\+\_\+t \&p)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classslvr__blk__2m__common_aab1df2789797c5b479d81a6b5869a53f}{rc\+\_\+src}} ()
\begin{DoxyCompactList}\small\item\em Cloud water source term. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__blk__2m__common_a0520b2c8f582d7f9a75f1372b43cfddd}{nc\+\_\+src}} ()
\begin{DoxyCompactList}\small\item\em Cloud droplet concentration source term. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__blk__2m__common_ae1055159bcbfa0beb14dc3e96579d5a7}{rr\+\_\+src}} ()
\begin{DoxyCompactList}\small\item\em Rain source term. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classslvr__blk__2m__common_a91fe670a353cfcc5c1beda82fda2d248}{nr\+\_\+src}} ()
\begin{DoxyCompactList}\small\item\em Rain drop concentration source term. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$class ct\+\_\+params\+\_\+t$>$\newline
class slvr\+\_\+blk\+\_\+2m\+\_\+common$<$ ct\+\_\+params\+\_\+t $>$}
Common base class for 2-\/moment bulk microphysics solver. 

Double-\/moment cloud microphysics, including handling of rain and cloud water mixing ratios, fluxes. Inherits from either \doxylink{classslvr__common}{slvr\+\_\+common} or slvr\+\_\+sgs depending on the SGS scheme.


\begin{DoxyTemplParams}{Template Parameters}
{\em ct\+\_\+params\+\_\+t} & Compile-\/time parameter struct defining solver options. \\
\hline
\end{DoxyTemplParams}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classslvr__blk__2m__common_ad5085adafa9d68b1e69d0ac541a4fc4f}\index{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}!slvr\_blk\_2m\_common@{slvr\_blk\_2m\_common}}
\index{slvr\_blk\_2m\_common@{slvr\_blk\_2m\_common}!slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{slvr\_blk\_2m\_common()}{slvr\_blk\_2m\_common()}}
{\footnotesize\ttfamily \label{classslvr__blk__2m__common_ad5085adafa9d68b1e69d0ac541a4fc4f} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
\mbox{\hyperlink{classslvr__blk__2m__common}{slvr\+\_\+blk\+\_\+2m\+\_\+common}} (\begin{DoxyParamCaption}\item[{typename parent\+\_\+t\+::ctor\+\_\+args\+\_\+t}]{args}{, }\item[{const rt\+\_\+params\+\_\+t \&}]{p}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em args} & Constructor arguments for parent class \\
\hline
{\em p} & Runtime parameters \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{classslvr__blk__2m__common_a0520b2c8f582d7f9a75f1372b43cfddd}\index{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}!nc\_src@{nc\_src}}
\index{nc\_src@{nc\_src}!slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{nc\_src()}{nc\_src()}}
{\footnotesize\ttfamily \label{classslvr__blk__2m__common_a0520b2c8f582d7f9a75f1372b43cfddd} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void nc\+\_\+src (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Cloud droplet concentration source term. 

Apply cloud droplet number (nc) source term due to large-\/scale vertical motion.

If {\ttfamily params.\+nc\+\_\+src} is true, the subsidence is applied and the forcing coefficient {\ttfamily alpha} is set from the large-\/scale forcing function {\ttfamily F()}. The {\ttfamily beta} coefficient is set to zero. \Hypertarget{classslvr__blk__2m__common_a91fe670a353cfcc5c1beda82fda2d248}\index{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}!nr\_src@{nr\_src}}
\index{nr\_src@{nr\_src}!slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{nr\_src()}{nr\_src()}}
{\footnotesize\ttfamily \label{classslvr__blk__2m__common_a91fe670a353cfcc5c1beda82fda2d248} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void nr\+\_\+src (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Rain drop concentration source term. 

Apply rain droplet number (nr) source term due to large-\/scale vertical motion.

If {\ttfamily params.\+nr\+\_\+src} is true, the subsidence is applied and the forcing coefficient {\ttfamily alpha} is set from the large-\/scale forcing function {\ttfamily F()}. The {\ttfamily beta} coefficient is set to zero. \Hypertarget{classslvr__blk__2m__common_aab1df2789797c5b479d81a6b5869a53f}\index{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}!rc\_src@{rc\_src}}
\index{rc\_src@{rc\_src}!slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{rc\_src()}{rc\_src()}}
{\footnotesize\ttfamily \label{classslvr__blk__2m__common_aab1df2789797c5b479d81a6b5869a53f} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void rc\+\_\+src (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Cloud water source term. 

Apply cloud water (rc) source term due to large-\/scale vertical motion.

If {\ttfamily params.\+rc\+\_\+src} is true, the subsidence is applied and the forcing coefficient {\ttfamily alpha} is set from the large-\/scale forcing function {\ttfamily F()}. The {\ttfamily beta} coefficient is set to zero. \Hypertarget{classslvr__blk__2m__common_ae1055159bcbfa0beb14dc3e96579d5a7}\index{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}!rr\_src@{rr\_src}}
\index{rr\_src@{rr\_src}!slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{rr\_src()}{rr\_src()}}
{\footnotesize\ttfamily \label{classslvr__blk__2m__common_ae1055159bcbfa0beb14dc3e96579d5a7} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void rr\+\_\+src (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Rain source term. 

Apply rain water (rr) source term due to large-\/scale vertical motion.

If {\ttfamily params.\+rr\+\_\+src} is true, the subsidence is applied and the forcing coefficient {\ttfamily alpha} is set from the large-\/scale forcing function {\ttfamily F()}. The {\ttfamily beta} coefficient is set to zero. \Hypertarget{classslvr__blk__2m__common_a9d61aec26a13f9277adb2c2ce2033b31}\index{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}!update\_rhs@{update\_rhs}}
\index{update\_rhs@{update\_rhs}!slvr\_blk\_2m\_common$<$ ct\_params\_t $>$@{slvr\_blk\_2m\_common$<$ ct\_params\_t $>$}}
\doxysubsubsection{\texorpdfstring{update\_rhs()}{update\_rhs()}}
{\footnotesize\ttfamily \label{classslvr__blk__2m__common_a9d61aec26a13f9277adb2c2ce2033b31} 
template$<$class ct\+\_\+params\+\_\+t$>$ \\
void update\+\_\+rhs (\begin{DoxyParamCaption}\item[{libmpdataxx\+::arrvec\+\_\+t$<$ typename parent\+\_\+t\+::arr\+\_\+t $>$ \&}]{rhs}{, }\item[{const typename parent\+\_\+t\+::real\+\_\+t \&}]{dt}{, }\item[{const int \&}]{at}{}\end{DoxyParamCaption})}



Update the right-\/hand-\/side of the prognostic equations. 

Update the right-\/hand side (RHS) of prognostic equations for 2-\/moment microphysics.


\begin{DoxyParams}{Parameters}
{\em rhs} & RHS arrays for all scalars \\
\hline
{\em dt} & Time step \\
\hline
{\em at} & Current step index\\
\hline
\end{DoxyParams}
This function updates the RHS arrays for all cloud and rain scalars, including temperature (th), water vapor (rv), cloud water (rc), cloud droplet number (nc), rain water (rr), and rain droplet number (nr). The updates include\+:


\begin{DoxyItemize}
\item Storing total liquid water (cloud + rain) for buoyancy calculations.
\item Calling the parent RHS update routine.
\item Zeroing precipitation fluxes at the first substep.
\item Applying cell-\/wise microphysics updates using {\ttfamily libcloudph++\+::blk\+\_\+2m\+::rhs\+\_\+cellwise}.
\item Applying source terms and nudging forcings for cloud and rain water and number concentrations.
\item Optionally adding subgrid-\/scale forces if using an explicit turbulence model.
\item Ensuring that the RHS does not remove more mass than is present (prevents negative values).
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em rhs} & Array of RHS fields for all scalars. Updated in-\/place. \\
\hline
{\em dt} & Time step size. \\
\hline
{\em at} & Substep index.
\begin{DoxyItemize}
\item 0\+: Eulerian integration or initial step for trapezoidal method
\item 1\+: trapezoidal n+1 step 
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
